{"ast":null,"code":"var _jsxFileName = \"/Users/vickywong/Documents/doggo-mart/src/Components/Home.js\";\nimport React, { useState, useEffect } from \"react\";\nimport \"../App.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Products from \"./Products\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Banner from \"./Banner\";\nimport Filter from \"./Filter\";\nimport Basket from \"./Basket\";\n\nfunction Home() {\n  const [products, setProducts] = useState([]);\n  const [cartItems, setCartItems] = useState([]);\n  const [sortValue, setSortValue] = useState(\"ascending\");\n  useEffect(() => {\n    const fetchData = async () => {\n      const res = await fetch(\"http://localhost:8000/products\");\n      const unsortedProducts = await res.json();\n      console.log(unsortedProducts, \"unsortedProducts\");\n      const sorted = sortProducts(unsortedProducts, sortValue); // set this up to combat useState not changing immediately (prevstate, result)\n\n      setProducts(sorted);\n    };\n\n    fetchData();\n  }, []);\n  useEffect(() => {\n    const storedCartItems = localStorage.cartItems;\n\n    if (storedCartItems) {\n      try {\n        const parsed = JSON.parse(storedCartItems);\n\n        if (Array.isArray(parsed) && parsed.length > 0 && parsed[0].id) {\n          setCartItems(parsed);\n          console.log(parsed, \"we set the items from localstorage\");\n        }\n      } catch (error) {// we don't care\n      }\n    } // localStorage.cartItems\n\n  }, []); // array is the list of things that should trigger the useEffect, if empty, then nothing should trigger it except first time\n\n  useEffect(() => {\n    localStorage.cartItems = JSON.stringify(cartItems);\n    console.log(\"saved cart items\"); //we are going to save the cart items here\n  }, [cartItems]);\n\n  const sortProducts = (list, sortValueToUse) => {\n    let sorted = list; // console.log(sorted, \"unsorted list\");\n\n    if (sortValueToUse === \"ascending\") {\n      sorted = list.sort((a, b) => a.price - b.price);\n    }\n\n    if (sortValueToUse === \"descending\") {\n      sorted = list.sort((a, b) => b.price - a.price);\n    } // console.log(sorted, \"sorted\");\n\n\n    return sorted;\n  }; // introducing another argument\n\n\n  const handleChangeSort = e => {\n    const newSortValue = e.target.value;\n    setSortValue(newSortValue);\n    const sorted = sortProducts(products, newSortValue);\n    setProducts(sorted); //setProducts() side effects, any of the ones that use useState setter functions = side effects\n\n    console.log(newSortValue, \"target value\");\n  };\n\n  const HandleAddToCart = product => {\n    const productInCart = cartItems.find(item => item.id === product.id);\n    let newCartItems = [...cartItems]; //new array,\n\n    if (productInCart) {\n      productInCart.count += 1;\n      console.log(productInCart.count, \"product In cart count\");\n    } else {\n      const newCartItem = product;\n      newCartItem.count = 1;\n      console.log(cartItems);\n      console.log(newCartItem.count, \"new item count\");\n      newCartItems = cartItems.concat(newCartItem);\n    }\n\n    console.log(\"final assignment\", newCartItems);\n    setCartItems(newCartItems);\n  };\n\n  const handleRemoveFromCart = product => {\n    const removedCartItems = cartItems.filter(a => a.id !== product.id);\n    setCartItems(removedCartItems);\n    console.log(removedCartItems, \"removed item\");\n  };\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(Banner, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }), React.createElement(Container, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 101\n    },\n    __self: this\n  }, React.createElement(\"h1\", {\n    className: \"homepage-title\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, \"Discover better-for-you Doggos\"), React.createElement(Row, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  }, React.createElement(Col, {\n    md: 9,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 105\n    },\n    __self: this\n  }, React.createElement(Filter, {\n    sortValue: sortValue,\n    handleChangeSort: handleChangeSort,\n    count: products.length,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 106\n    },\n    __self: this\n  }), React.createElement(\"hr\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }), React.createElement(Products, {\n    products: products,\n    setProducts: setProducts,\n    HandleAddToCart: HandleAddToCart,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  })), React.createElement(Col, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121\n    },\n    __self: this\n  }, React.createElement(Basket, {\n    cartItems: cartItems,\n    handleRemoveFromCart: handleRemoveFromCart,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  })))));\n}\n\nexport default Home; //function supposed to be updating the page isn't running\n//console.log shows number of item is correct when added\n//however, cart is one step behind if it's same item\n// before we were mutating the old reference (e.g. let newCartItems = [cartItems];)\n// make an entire new copy of the state, and change that instead\n// react: thinks nothing changed cause reference is the same before creating a new copy\n//let newCartItems = [...cartItems]","map":{"version":3,"sources":["/Users/vickywong/Documents/doggo-mart/src/Components/Home.js"],"names":["React","useState","useEffect","Products","Container","Row","Col","Banner","Filter","Basket","Home","products","setProducts","cartItems","setCartItems","sortValue","setSortValue","fetchData","res","fetch","unsortedProducts","json","console","log","sorted","sortProducts","storedCartItems","localStorage","parsed","JSON","parse","Array","isArray","length","id","error","stringify","list","sortValueToUse","sort","a","b","price","handleChangeSort","e","newSortValue","target","value","HandleAddToCart","product","productInCart","find","item","newCartItems","count","newCartItem","concat","handleRemoveFromCart","removedCartItems","filter"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from \"react\";\nimport \"../App.css\";\nimport \"bootstrap/dist/css/bootstrap.min.css\";\nimport Products from \"./Products\";\nimport Container from \"react-bootstrap/Container\";\nimport Row from \"react-bootstrap/Row\";\nimport Col from \"react-bootstrap/Col\";\nimport Banner from \"./Banner\";\nimport Filter from \"./Filter\";\nimport Basket from \"./Basket\";\n\nfunction Home() {\n  const [products, setProducts] = useState([]);\n  const [cartItems, setCartItems] = useState([]);\n  const [sortValue, setSortValue] = useState(\"ascending\");\n\n  useEffect(() => {\n    const fetchData = async () => {\n      const res = await fetch(\"http://localhost:8000/products\");\n      const unsortedProducts = await res.json();\n      console.log(unsortedProducts, \"unsortedProducts\");\n      const sorted = sortProducts(unsortedProducts, sortValue);\n      // set this up to combat useState not changing immediately (prevstate, result)\n      setProducts(sorted);\n    };\n    fetchData();\n  }, []);\n\n  useEffect(() => {\n    const storedCartItems = localStorage.cartItems;\n    if (storedCartItems) {\n      try {\n        const parsed = JSON.parse(storedCartItems);\n        if (Array.isArray(parsed) && parsed.length > 0 && parsed[0].id) {\n          setCartItems(parsed);\n          console.log(parsed, \"we set the items from localstorage\")\n        }\n      } catch(error) {\n        // we don't care\n      }\n    }\n    // localStorage.cartItems\n  }, []); // array is the list of things that should trigger the useEffect, if empty, then nothing should trigger it except first time\n\nuseEffect(() => {\n  localStorage.cartItems = JSON.stringify(cartItems);\n  console.log(\"saved cart items\")\n  //we are going to save the cart items here\n},[cartItems])\n\n  const sortProducts = (list, sortValueToUse) => {\n    let sorted = list;\n    // console.log(sorted, \"unsorted list\");\n    if (sortValueToUse === \"ascending\") {\n      sorted = list.sort((a, b) => a.price - b.price);\n    }\n    if (sortValueToUse === \"descending\") {\n      sorted = list.sort((a, b) => b.price - a.price);\n    }\n    // console.log(sorted, \"sorted\");\n    return sorted;\n  };\n\n  // introducing another argument\n\n  const handleChangeSort = (e) => {\n    const newSortValue = e.target.value;\n    setSortValue(newSortValue);\n    const sorted = sortProducts(products, newSortValue);\n    setProducts(sorted);\n    //setProducts() side effects, any of the ones that use useState setter functions = side effects\n    console.log(newSortValue, \"target value\");\n  };\n\n  const HandleAddToCart = (product) => {\n    const productInCart = cartItems.find((item) => item.id === product.id);\n    let newCartItems = [...cartItems]; //new array,\n    if (productInCart) {\n      productInCart.count += 1;\n      console.log(productInCart.count, \"product In cart count\");\n    } else {\n      const newCartItem = product;\n      newCartItem.count = 1;\n      console.log(cartItems);\n      console.log(newCartItem.count, \"new item count\");\n      newCartItems = cartItems.concat(newCartItem);\n    }\n    console.log(\"final assignment\", newCartItems);\n    setCartItems(newCartItems);\n  };\n\n  const handleRemoveFromCart = (product) => {\n    const removedCartItems = cartItems.filter((a) => a.id !== product.id);\n    setCartItems(removedCartItems);\n    console.log(removedCartItems, \"removed item\");\n  };\n\n  return (\n    <div>\n      <Banner />\n      <Container>\n        <h1 className=\"homepage-title\">Discover better-for-you Doggos</h1>\n\n        <Row>\n          <Col md={9}>\n            <Filter\n              sortValue={sortValue}\n              handleChangeSort={handleChangeSort}\n              count={products.length}\n            />\n\n            <hr />\n\n            <Products\n              products={products}\n              setProducts={setProducts}\n              HandleAddToCart={HandleAddToCart}\n            />\n          </Col>\n\n          <Col>\n            <Basket\n              cartItems={cartItems}\n              handleRemoveFromCart={handleRemoveFromCart}\n            />\n          </Col>\n        </Row>\n      </Container>\n    </div>\n  );\n}\n\nexport default Home;\n\n//function supposed to be updating the page isn't running\n//console.log shows number of item is correct when added\n//however, cart is one step behind if it's same item\n\n// before we were mutating the old reference (e.g. let newCartItems = [cartItems];)\n// make an entire new copy of the state, and change that instead\n// react: thinks nothing changed cause reference is the same before creating a new copy\n//let newCartItems = [...cartItems]\n"]},"metadata":{},"sourceType":"module"}